<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GitPod Flix - Rust Edition</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white">
    <div id="root"></div>
    
    <script type="text/babel">
        const { useState, useEffect } = React;
        
        function App() {
            const [movies, setMovies] = useState([]);
            const [loading, setLoading] = useState(true);
            
            useEffect(() => {
                fetchMovies();
            }, []);
            
            const fetchMovies = async () => {
                try {
                    const response = await fetch('/api/movies');
                    const data = await response.json();
                    setMovies(data);
                } catch (error) {
                    console.error('Error fetching movies:', error);
                } finally {
                    setLoading(false);
                }
            };
            
            const seedDatabase = async () => {
                try {
                    await fetch('/api/movies/seed', { method: 'POST' });
                    fetchMovies();
                } catch (error) {
                    console.error('Error seeding database:', error);
                }
            };
            
            const clearDatabase = async () => {
                try {
                    await fetch('/api/movies/clear', { method: 'POST' });
                    fetchMovies();
                } catch (error) {
                    console.error('Error clearing database:', error);
                }
            };
            
            if (loading) {
                return <div className="flex justify-center items-center h-screen">Loading...</div>;
            }
            
            return (
                <div className="min-h-screen">
                    <nav className="bg-red-600 p-4">
                        <div className="container mx-auto flex justify-between items-center">
                            <h1 className="text-2xl font-bold">GitPod Flix (Rust)</h1>
                            <div className="space-x-4">
                                <button 
                                    onClick={seedDatabase}
                                    className="bg-green-600 hover:bg-green-700 px-4 py-2 rounded"
                                >
                                    Seed Database
                                </button>
                                <button 
                                    onClick={clearDatabase}
                                    className="bg-red-800 hover:bg-red-900 px-4 py-2 rounded"
                                >
                                    Clear Database
                                </button>
                            </div>
                        </div>
                    </nav>
                    
                    <main className="container mx-auto p-4">
                        <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
                            {movies.map(movie => (
                                <div key={movie.id} className="bg-gray-800 rounded-lg overflow-hidden shadow-lg">
                                    <img 
                                        src={movie.image_url} 
                                        alt={movie.title}
                                        className="w-full h-64 object-cover"
                                    />
                                    <div className="p-4">
                                        <h3 className="text-xl font-bold mb-2">{movie.title}</h3>
                                        <p className="text-gray-400 text-sm mb-2">{movie.release_year}</p>
                                        <p className="text-yellow-400 mb-2">â˜… {movie.rating}</p>
                                        <p className="text-gray-300 text-sm">{movie.description}</p>
                                    </div>
                                </div>
                            ))}
                        </div>
                        
                        {movies.length === 0 && (
                            <div className="text-center py-12">
                                <p className="text-gray-400 text-xl">No movies found. Try seeding the database!</p>
                            </div>
                        )}
                    </main>
                </div>
            );
        }
        
        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
